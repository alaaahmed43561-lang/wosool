// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨
const trainings = {
    'national-id': {
        title: 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨Ø·Ø§Ù‚Ø© Ø±Ù‚Ù… Ù‚ÙˆÙ…ÙŠ',
        website: 'https://www.egypt.gov.eg',
        steps: [
            {
                number: 1,
                title: 'Ø§ÙØªØ­ Ù…ÙˆÙ‚Ø¹ Ù…ØµØ± Ø§Ù„Ø±Ù‚Ù…ÙŠØ©',
                description: 'Ø³Ù†ÙØªØ­ Ù…Ø¹Ø§Ùƒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹.',
                url: 'https://www.egypt.gov.eg',
                steps: [
                    'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹',
                    'Ø§Ù†ØªØ¸Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹',
                    'Ø¥Ø°Ø§ Ø¸Ù‡Ø± ØªØ­Ø°ÙŠØ±ØŒ Ø§Ø¶ØºØ· "Ù…ØªØ§Ø¨Ø¹Ø©"'
                ],
                tips: [
                    'Ø§Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©',
                    'ØªØ£ÙƒØ¯ Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ù‚ÙÙ„ Ø§Ù„Ø£Ø®Ø¶Ø±',
                    'Ø¥Ø°Ø§ Ù„Ù… ÙŠÙØªØ­ØŒ Ø­Ø§ÙˆÙ„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·'
                ],
                audio: 'Ø§ÙØªØ­ Ù…ÙˆÙ‚Ø¹ Ù…ØµØ± Ø§Ù„Ø±Ù‚Ù…ÙŠØ©. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ.'
            },
            {
                number: 2,
                title: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
                description: 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡.',
                steps: [
                    'Ø§Ø¨Ø­Ø« Ø¹Ù† "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„" ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰',
                    'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±',
                    'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ',
                    'Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±'
                ],
                tips: [
                    'Ø¥Ø°Ø§ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŒ Ø§Ø¶ØºØ· "Ù†Ø³ÙŠØª"',
                    'ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ',
                    'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø­Ø³Ø§Ø³Ø© Ù„Ù„Ø£Ø­Ø±Ù'
                ],
                audio: 'Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„. Ø§Ø¨Ø­Ø« Ø¹Ù† Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹.'
            },
            {
                number: 3,
                title: 'Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø©',
                description: 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ø®Ø¯Ù…Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©.',
                steps: [
                    'Ø§ÙƒØªØ¨ "Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©" ÙÙŠ Ø§Ù„Ø¨Ø­Ø«',
                    'Ø§Ø¶ØºØ· Enter',
                    'Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬'
                ],
                tips: [
                    'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø¨Ù€ "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ"',
                    'ØªØ£ÙƒØ¯ Ø£Ù†Ù‡Ø§ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©',
                    'Ø§Ù‚Ø±Ø£ Ø§Ù„ÙˆØµÙ Ø¬ÙŠØ¯Ø§Ù‹'
                ],
                audio: 'Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø§Ø¨Ø­Ø« Ø¹Ù† Ø®Ø¯Ù…Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©.'
            },
            {
                number: 4,
                title: 'ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬',
                description: 'Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬.',
                steps: [
                    'Ø§Ù…Ù„Ø£ Ø§Ù„Ø§Ø³Ù… ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©',
                    'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„',
                    'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©',
                    'Ø­Ù…Ù‘Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©'
                ],
                tips: [
                    'ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
                    'Ø§Ù„ØµÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø­Ø¯ÙŠØ«Ø©',
                    'Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ² 2 Ù…ÙŠØ¬Ø§'
                ],
                audio: 'Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©: Ø§Ù…Ù„Ø£ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§ØªÙƒ.'
            },
            {
                number: 5,
                title: 'Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
                description: 'Ø§Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹.',
                steps: [
                    'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"',
                    'Ø§Ø®ØªØ± ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹',
                    'Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹',
                    'Ø§Ø¶ØºØ· "ØªØ£ÙƒÙŠØ¯"'
                ],
                tips: [
                    'ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† HTTPS',
                    'Ø§Ø­ÙØ¸ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹',
                    'Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©'
                ],
                audio: 'Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø®Ø§Ù…Ø³Ø©: Ø§Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹.'
            }
        ]
    },
    
    'electricity': {
        title: 'Ø¯ÙØ¹ ÙØ§ØªÙˆØ±Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡',
        website: 'https://epay.eehc.gov.eg',
        steps: [
            {
                number: 1,
                title: 'Ø§ÙØªØ­ Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡',
                description: 'Ø§ÙØªØ­ Ù…ÙˆÙ‚Ø¹ Ø´Ø±ÙƒØ© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ù„Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.',
                url: 'https://epay.eehc.gov.eg',
                audio: 'Ø§ÙØªØ­ Ù…ÙˆÙ‚Ø¹ Ø´Ø±ÙƒØ© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡.'
            },
            {
                number: 2,
                title: 'Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯',
                description: 'Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡.',
                audio: 'Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©.'
            },
            {
                number: 3,
                title: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº',
                description: 'ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.',
                audio: 'ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚.'
            },
            {
                number: 4,
                title: 'Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹',
                description: 'Ø§Ø¯ÙØ¹ Ø§Ù„Ù…Ø¨Ù„Øº.',
                audio: 'Ø§Ø¯ÙØ¹ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø·Ø§Ù‚ØªÙƒ.'
            }
        ]
    },
    
    'appointment': {
        title: 'Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø·Ø¨ÙŠ',
        steps: [
            {
                number: 1,
                title: 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰',
                description: 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠ.',
                audio: 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙÙŠÙ‡.'
            }
        ]
    }
};

// Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø­Ø§Ù„ÙŠ
let currentTraining = null;
let currentStep = 0;

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸš€ Ù…ÙˆÙ‚Ø¹ ÙˆØµÙˆÙ„ Ø¬Ø§Ù‡Ø²!');
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¯Ø±ÙŠØ¨
    setupTrainingButtons();
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
    setupControlButtons();
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ
    setupAudioButtons();
});

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± "Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯Ø±ÙŠØ¨"
function setupTrainingButtons() {
    const buttons = document.querySelectorAll('.start-btn');
    
    buttons.forEach(button => {
        button.addEventListener('click', function() {
            const trainingId = this.getAttribute('data-training');
            console.log('ğŸ¯ Ø¨Ø¯Ø¡ ØªØ¯Ø±ÙŠØ¨:', trainingId);
            startTraining(trainingId);
        });
    });
}

// Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
function startTraining(trainingId) {
    if (!trainings[trainingId]) {
        showNotification('ğŸš« Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹');
        return;
    }
    
    currentTraining = trainings[trainingId];
    currentStep = 0;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
    document.getElementById('simulator-title').textContent = currentTraining.title;
    document.getElementById('total-steps').textContent = currentTraining.steps.length;
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ
    document.querySelector('.training-simulator').classList.remove('hidden');
    
    // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ù…Ø­Ø§ÙƒÙŠ
    document.querySelector('.training-simulator').scrollIntoView({ 
        behavior: 'smooth' 
    });
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰
    loadStep(currentStep);
    
    // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¨Ø¯Ø¡
    showNotification(`ğŸ¬ Ø¨Ø¯Ø¡ ØªØ¯Ø±ÙŠØ¨ "${currentTraining.title}"`);
    
    // ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
    setTimeout(() => {
        if (currentTraining.website) {
            window.open(currentTraining.website, '_blank', 'width=1200,height=700');
            showNotification('ğŸŒ ØªÙ… ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©');
        }
    }, 1000);
}

// ØªØ­Ù…ÙŠÙ„ Ø®Ø·ÙˆØ©
function loadStep(stepIndex) {
    if (!currentTraining || !currentTraining.steps[stepIndex]) {
        return;
    }
    
    const step = currentTraining.steps[stepIndex];
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
    document.getElementById('current-step').textContent = step.number;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    document.getElementById('step-title').textContent = step.title;
    document.getElementById('step-description').textContent = step.description;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø·
    const linkBtn = document.getElementById('website-link');
    if (step.url) {
        linkBtn.href = step.url;
        linkBtn.style.display = 'flex';
    } else if (currentTraining.website) {
        linkBtn.href = currentTraining.website;
        linkBtn.style.display = 'flex';
    } else {
        linkBtn.style.display = 'none';
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø·ÙˆØ§Øª
    const stepsList = document.getElementById('step-steps');
    stepsList.innerHTML = '';
    if (step.steps) {
        step.steps.forEach(stepText => {
            const li = document.createElement('li');
            li.textContent = stepText;
            stepsList.appendChild(li);
        });
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµØ§Ø¦Ø­
    const tipsList = document.getElementById('step-tips');
    tipsList.innerHTML = '';
    if (step.tips) {
        step.tips.forEach(tip => {
            const li = document.createElement('li');
            li.textContent = tip;
            tipsList.appendChild(li);
        });
    }
    
    // Ù‚Ø±Ø§Ø¡Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø¹Ø¯ Ù†ØµÙ Ø«Ø§Ù†ÙŠØ©
    setTimeout(() => {
        readStep(step);
    }, 500);
}

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø®Ø·ÙˆØ©
function readStep(step) {
    if (!('speechSynthesis' in window)) {
        showNotification('ğŸ”‡ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø®Ø¯Ù… Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØªÙŠØ©');
        return;
    }
    
    // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø³Ø§Ø¨Ù‚Ø©
    window.speechSynthesis.cancel();
    
    // Ø§Ù„Ù†Øµ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø©
    const text = step.audio || step.description;
    const utterance = new SpeechSynthesisUtterance(text);
    
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª
    utterance.lang = 'ar-SA';
    utterance.rate = 0.9;
    utterance.pitch = 1;
    utterance.volume = 1;
    
    // Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØª Ø¹Ø±Ø¨ÙŠ
    const voices = window.speechSynthesis.getVoices();
    const arabicVoice = voices.find(v => v.lang.startsWith('ar'));
    if (arabicVoice) {
        utterance.voice = arabicVoice;
    }
    
    // Ø§Ù„Ø¨Ø¯Ø¡
    window.speechSynthesis.speak(utterance);
    showNotification('ğŸ”Š Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø´Ø±Ø­...');
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
function setupControlButtons() {
    // Ø²Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚
    document.getElementById('prev-btn').addEventListener('click', function() {
        if (currentStep > 0) {
            currentStep--;
            loadStep(currentStep);
            showNotification('â†©ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©');
        }
    });
    
    // Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
    document.getElementById('next-btn').addEventListener('click', function() {
        if (currentTraining && currentStep < currentTraining.steps.length - 1) {
            currentStep++;
            loadStep(currentStep);
            showNotification('â†ªï¸ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©');
        } else {
            finishTraining();
        }
    });
    
    // Ø²Ø± Ø¥Ù†Ù‡Ø§Ø¡
    document.getElementById('finish-btn').addEventListener('click', finishTraining);
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµÙˆØª
function setupAudioButtons() {
    // Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„
    document.getElementById('play-audio').addEventListener('click', function() {
        if (currentTraining && currentTraining.steps[currentStep]) {
            readStep(currentTraining.steps[currentStep]);
        }
    });
    
    // Ø²Ø± Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø©
    document.getElementById('repeat-audio').addEventListener('click', function() {
        window.speechSynthesis.cancel();
        setTimeout(() => {
            if (currentTraining && currentTraining.steps[currentStep]) {
                readStep(currentTraining.steps[currentStep]);
            }
        }, 300);
    });
}

// Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
function finishTraining() {
    if (!currentTraining) return;
    
    // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª
    window.speechSynthesis.cancel();
    
    // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
    showNotification(`ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø£ÙƒÙ…Ù„Øª ØªØ¯Ø±ÙŠØ¨ "${currentTraining.title}"`);
    
    // Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
    setTimeout(() => {
        document.querySelector('.training-simulator').classList.add('hidden');
        document.getElementById('home').scrollIntoView({ behavior: 'smooth' });
        currentTraining = null;
        currentStep = 0;
    }, 3000);
}

// Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
function showNotification(message) {
    const notification = document.getElementById('notification');
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
    notification.textContent = message;
    notification.className = 'notification show';
    
    // Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
    setTimeout(() => {
        notification.className = 'notification';
    }, 3000);
}

// ÙˆØ¸Ø§Ø¦Ù Ø´Ø±ÙŠØ· Ø§Ù„ÙˆØµÙˆÙ„
function increaseFont() {
    document.body.style.fontSize = '18px';
    showNotification('ğŸ” ØªÙ… ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø·');
}

function decreaseFont() {
    document.body.style.fontSize = '16px';
    showNotification('ğŸ” ØªÙ… ØªØµØºÙŠØ± Ø§Ù„Ø®Ø·');
}

function toggleContrast() {
    document.body.classList.toggle('high-contrast');
    showNotification('ğŸ¨ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„ØªØ¨Ø§ÙŠÙ†');
}

function readPage() {
    const title = document.querySelector('h1').textContent;
    const content = document.querySelector('.subtitle').textContent;
    
    const utterance = new SpeechSynthesisUtterance(title + '. ' + content);
    utterance.lang = 'ar-SA';
    window.speechSynthesis.speak(utterance);
    showNotification('ğŸ”Š Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙØ­Ø©');
}

function stopReading() {
    window.speechSynthesis.cancel();
    showNotification('â¹ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©');
}
